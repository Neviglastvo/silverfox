<!doctype html>
<html>
<head>
	<meta charset="utf-8" />
	<title><%= pages.ProjectTitle %></title>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="theme-color" content="#fff" />
	<meta name="format-detection" content="telephone=no" />
	<link href="https://fonts.googleapis.com/css?family=Oswald:300,500,700&display=swap&subset=cyrillic" rel="stylesheet">
</head>
<style>
@-webkit-keyframes label-active{0%{-webkit-box-shadow:0 0 #e4e8e1;box-shadow:0 0 #e4e8e1}to{-webkit-box-shadow:0 0 10px 8px transparent;box-shadow:0 0 10px 8px transparent}}@keyframes label-active{0%{-webkit-box-shadow:0 0 #e4e8e1;box-shadow:0 0 #e4e8e1}to{-webkit-box-shadow:0 0 10px 8px transparent;box-shadow:0 0 10px 8px transparent}}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;vertical-align:baseline}fieldset,img{margin:0;padding:0;vertical-align:baseline}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-webkit-box-sizing:border-box;box-sizing:border-box}a img,fieldset,img{border:0}input[type=email],input[type=tel],input[type=text],textarea{-webkit-appearance:none}button,input[type=submit]{cursor:pointer}button::-moz-focus-inner,input[type=submit]::-moz-focus-inner{padding:0;border:0}textarea{overflow:auto}button,input{margin:0;padding:0;border:0}a,a:focus,button,div,h1,h2,h3,h4,h5,h6,input,select,span,textarea{outline:0}ol,ul{list-style-type:none}table{border-spacing:0;border-collapse:collapse;width:100%}*,:after,:before{-webkit-box-sizing:inherit;box-sizing:inherit}.content,.content__item{display:-webkit-box;display:-ms-flexbox;display:flex}.content{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;border:2px solid #801336}.content__item{position:relative;width:100%;height:100%}.content__iframe{position:absolute;top:0;left:0;width:100%;height:100%}.devices{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.devices__item{margin-right:6px;width:34px;height:34px;background-color:rgba(128,19,54,.4);border-radius:4px;position:relative;opacity:.8;padding:3px;-webkit-transition:all 300ms;-o-transition:all 300ms;transition:all 300ms}.devices__item:hover{cursor:pointer;opacity:1}.devices__item:last-child{margin-right:0}.devices__item.active{pointer-events:none;opacity:1;background-color:#801336}.devices__item.active svg{fill:#e4e8e1}.devices__item svg{padding:3px;width:100%;height:100%;fill:#e4e8e1}.header{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:4px 10px}.header,.header__block,.header__box{display:-webkit-box;display:-ms-flexbox;display:flex}.header__box{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.header__block{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.header__logo{width:40px;height:40px;border-radius:50%;margin-right:15px;background-color:#801336}.label{width:100%;overflow:hidden;height:28px}.label__container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;width:100%;overflow-y:hidden;overflow-x:auto;-webkit-box-sizing:content-box;box-sizing:content-box}.label__item,.label__status{-webkit-transition:all 300ms;-o-transition:all 300ms;transition:all 300ms}.label__item{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 7px 2px;background-color:#801336;margin-right:2px;opacity:.7;height:28px;width:auto;border-radius:4px 4px 0 0}.label__item:hover{cursor:pointer;opacity:.8;background-color:#801336}.label__item .label__status,.label__item.disabled .label__url{display:none}.label__item.disabled{-webkit-filter:grayscale(100%);filter:grayscale(100%);pointer-events:none}.label__item.inProgress .label__status,.label__item.ready .label__status{display:block;background-color:#61ef61;-webkit-animation:none;animation:none;-webkit-box-shadow:0 0 5px 1px #61ef61;box-shadow:0 0 5px 1px #61ef61}.label__item.inProgress .label__status{background-color:#ff0;-webkit-box-shadow:0 0 5px 1px #ff0;box-shadow:0 0 5px 1px #ff0}.label__item.active{border-radius:4px 4px 0 0;opacity:1}.label__item.active .label__status{display:block;-webkit-animation:label-active 2s ease infinite;animation:label-active 2s ease infinite}.label__status{width:6px;height:6px;border-radius:50%;pointer-events:none;margin:0 4px}.label__name{display:block;margin:0 6px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;font-size:16px;line-height:28px;font-weight:300;color:#e4e8e1}.label__name,.label__name:hover{text-decoration:none}.label__url{position:relative;height:14px;width:14px;opacity:.6;-webkit-transition:all 300ms;-o-transition:all 300ms;transition:all 300ms}.label__url:hover{opacity:1}.label__url svg{position:absolute;top:0;left:0;width:100%;height:100%;fill:#e4e8e1}.window{width:100vw;height:100vh;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;position:relative;color:#feeffd;border-top:none;font-family:"Oswald",sans-serif;background:-o-linear-gradient(135deg,#323232 0%,#3f3f3f 50%,#1c1c1c 150%),-o-linear-gradient(bottom,rgba(255,255,255,.4) 0%,rgba(0,0,0,.25) 200%);background:linear-gradient(-45deg,#323232 0%,#3f3f3f 50%,#1c1c1c 150%),linear-gradient(to top,rgba(255,255,255,.4) 0%,rgba(0,0,0,.25) 200%);background-blend-mode:multiply}
</style>
<body>
	<?xml version="1.0" encoding="UTF-8"?>
	<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg style="display: none;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
		<symbol id="svg-tablet" viewBox="0 0 443.979 443.979">
			<path d="M372.72,0H71.259c-14.48,0-26.261,11.781-26.261,26.261v391.457c0,14.48,11.78,26.261,26.261,26.261H372.72   c14.48,0,26.261-11.781,26.261-26.261V26.261C398.981,11.781,387.2,0,372.72,0z M383.981,417.718   c0,6.209-5.052,11.261-11.261,11.261H71.259c-6.209,0-11.261-5.052-11.261-11.261V26.261C59.998,20.052,65.05,15,71.259,15H372.72   c6.209,0,11.261,5.052,11.261,11.261V417.718z" />
			<path d="m368.982,47.908h-293.985c-2.761,0-5,2.239-5,5v338.163c0,2.761 2.239,5 5,5h293.985c2.761,0 5-2.239 5-5v-338.163c0-2.762-2.239-5-5-5zm-5,338.163h-283.985v-328.163h283.985v328.163z" />
			<path d="m221.992,406.478c-1.98,0-3.91,0.8-5.31,2.2-1.39,1.39-2.19,3.33-2.19,5.3 0,1.97 0.8,3.91 2.19,5.3 1.4,1.4 3.33,2.2 5.31,2.2 1.97,0 3.91-0.8 5.3-2.2 1.4-1.39 2.2-3.33 2.2-5.3 0-1.97-0.8-3.91-2.2-5.3-1.4-1.4-3.33-2.2-5.3-2.2z" />
			<path d="m221.992,37.248c1.31,0 2.6-0.53 3.53-1.46 0.93-0.93 1.47-2.22 1.47-3.54 0-1.32-0.54-2.6-1.47-3.54-0.93-0.93-2.22-1.46-3.53-1.46-1.32,0-2.61,0.53-3.54,1.46-0.93,0.93-1.46,2.22-1.46,3.54 0,1.32 0.53,2.61 1.46,3.54 0.93,0.93 2.22,1.46 3.54,1.46z" />
		</symbol>
		<symbol id="svg-phone" viewBox="0 0 512 512">
			<path d="M128.043,405.674c4.142,0,7.5-3.358,7.5-7.5V123.847c0-4.142-3.358-7.5-7.5-7.5c-4.142,0-7.5,3.358-7.5,7.5v274.328   C120.543,402.316,123.901,405.674,128.043,405.674z" />
			<path d="M384.044,263.544c-4.142,0-7.5,3.358-7.5,7.5v203.544c0,12.407-10.093,22.5-22.5,22.5H158.043   c-12.407,0-22.5-10.093-22.5-22.5v-46.414c0-4.142-3.358-7.5-7.5-7.5c-4.142,0-7.5,3.358-7.5,7.5v46.414   c0,20.678,16.822,37.5,37.5,37.5h196.001c20.678,0,37.5-16.822,37.5-37.5V271.044C391.544,266.902,388.187,263.544,384.044,263.544   z" />
			<path d="M354.044,0H158.043c-20.678,0-37.5,16.822-37.5,37.5v56.347c0,4.142,3.358,7.5,7.5,7.5c4.142,0,7.5-3.358,7.5-7.5V37.5   c0-12.407,10.093-22.5,22.5-22.5h31.37c7.614,15.287,23.369,25.233,40.735,25.233h51.791c17.366,0,33.121-9.946,40.735-25.233   h31.37c12.407,0,22.5,10.093,22.5,22.5v203.544c0,4.142,3.358,7.5,7.5,7.5c4.142,0,7.5-3.358,7.5-7.5V37.5   C391.544,16.822,374.722,0,354.044,0z M281.939,25.233h-51.791c-8.863,0-17.099-3.866-22.778-10.233h97.348   C299.038,21.367,290.802,25.233,281.939,25.233z" />
			<path d="M286.863,478.473c4.142,0,7.5-3.358,7.5-7.5c0-4.142-3.358-7.5-7.5-7.5h-61.639c-4.142,0-7.5,3.358-7.5,7.5   c0,4.142,3.358,7.5,7.5,7.5H286.863z" />
		</symbol>
		<symbol id="svg-notebook" viewBox="0 0 114.661 114.661">
			<path d="M114.515,88.813h-6.816c0.59-0.826,0.946-1.833,0.946-2.925V27.206c0-2.79-2.271-5.059-5.061-5.059H11.011
			c-2.789,0-5.059,2.27-5.059,5.059v58.682c0,1.114,0.374,2.138,0.987,2.976H0.058c0,0-0.309,0.313,0.506,1.127
			c2.311,2.312,7.502,2.512,7.502,2.512v-0.006c0,0,97.234,0.023,97.342,0.017c5.42,0,7.17-1.625,8.603-2.573
			C115.072,88.875,114.515,88.813,114.515,88.813z M63.798,90.047H50.771v-0.885h13.025L63.798,90.047L63.798,90.047z M104.91,84.725
			H9.536V25.558h95.375V84.725z" />
		</symbol>
		<symbol id="svg-desktop" viewBox="0 0 33 33">
			<path d="M30.5,26.109h-28c-1.378,0-2.5-1.121-2.5-2.5V4.61c0-1.379,1.122-2.5,2.5-2.5h28c1.378,0,2.5,1.121,2.5,2.5v18.999
			C33,24.988,31.878,26.109,30.5,26.109z M2.5,3.11C1.673,3.11,1,3.783,1,4.61v18.999c0,0.827,0.673,1.5,1.5,1.5h28
			c0.827,0,1.5-0.673,1.5-1.5V4.61c0-0.827-0.673-1.5-1.5-1.5H2.5z" />
			<path d="M22.875,30.89h-12.75c-0.276,0-0.5-0.224-0.5-0.5s0.224-0.5,0.5-0.5h12.75c0.276,0,0.5,0.224,0.5,0.5
			S23.151,30.89,22.875,30.89z" />
			<path d="M16.5,30.89c-0.276,0-0.5-0.224-0.5-0.5v-4.781c0-0.276,0.224-0.5,0.5-0.5s0.5,0.224,0.5,0.5v4.781
			C17,30.667,16.776,30.89,16.5,30.89z" />
		</symbol>
		<symbol id="svg-link" viewBox="0 0 512.092 512.092">
			<path d="M312.453,199.601c-6.066-6.102-12.792-11.511-20.053-16.128c-19.232-12.315-41.59-18.859-64.427-18.859
			c-31.697-0.059-62.106,12.535-84.48,34.987L34.949,308.23c-22.336,22.379-34.89,52.7-34.91,84.318
			c-0.042,65.98,53.41,119.501,119.39,119.543c31.648,0.11,62.029-12.424,84.395-34.816l89.6-89.6
			c1.628-1.614,2.537-3.816,2.524-6.108c-0.027-4.713-3.87-8.511-8.583-8.484h-3.413c-18.72,0.066-37.273-3.529-54.613-10.581
			c-3.195-1.315-6.867-0.573-9.301,1.877l-64.427,64.512c-20.006,20.006-52.442,20.006-72.448,0
			c-20.006-20.006-20.006-52.442,0-72.448l108.971-108.885c19.99-19.965,52.373-19.965,72.363,0
			c13.472,12.679,34.486,12.679,47.957,0c5.796-5.801,9.31-13.495,9.899-21.675C322.976,216.108,319.371,206.535,312.453,199.601z" />
			<path d="M477.061,34.993c-46.657-46.657-122.303-46.657-168.96,0l-89.515,89.429c-2.458,2.47-3.167,6.185-1.792,9.387
			c1.359,3.211,4.535,5.272,8.021,5.205h3.157c18.698-0.034,37.221,3.589,54.528,10.667c3.195,1.315,6.867,0.573,9.301-1.877
			l64.256-64.171c20.006-20.006,52.442-20.006,72.448,0c20.006,20.006,20.006,52.442,0,72.448l-80.043,79.957l-0.683,0.768
			l-27.989,27.819c-19.99,19.965-52.373,19.965-72.363,0c-13.472-12.679-34.486-12.679-47.957,0
			c-5.833,5.845-9.35,13.606-9.899,21.845c-0.624,9.775,2.981,19.348,9.899,26.283c9.877,9.919,21.433,18.008,34.133,23.893
			c1.792,0.853,3.584,1.536,5.376,2.304c1.792,0.768,3.669,1.365,5.461,2.048c1.792,0.683,3.669,1.28,5.461,1.792l5.035,1.365
			c3.413,0.853,6.827,1.536,10.325,2.133c4.214,0.626,8.458,1.025,12.715,1.195h5.973h0.512l5.12-0.597
			c1.877-0.085,3.84-0.512,6.059-0.512h2.901l5.888-0.853l2.731-0.512l4.949-1.024h0.939c20.961-5.265,40.101-16.118,55.381-31.403
			l108.629-108.629C523.718,157.296,523.718,81.65,477.061,34.993z" />
		</symbol>
		<!--   <symbol id="svg-" viewBox=""></symbol> -->
	</svg>
	<div class="window">
		<div class="header">
			<div class="header__box">
				<div class="header__logo"></div>
				<div class="header__block">
					<div class="header__name">
						<%= pages.ProjectTitle %>
					</div>

					<%
					date = new Date(_.now());
					if(date.getMonth()+1<10){ month = '0' + (date.getMonth()+1);}
					else{ month = date.getMonth()+1; }

					if(date.getDate()<10){ day = '0' + (date.getDate());}
					else{ day = date.getDate(); }
					%>

					<div class="header__name">
						Total pages: <%=  pages.PageList.length %>.
						Updated <%= day %>.<%= month %>.<%= date.getFullYear() %>.
					</div>
				</div>
			</div>
			<div class="devices">
				<div class="devices__item js-device-button" data-mode="mobile" data-width="320">
					<svg>
						<use xlink:href="#svg-phone"></use>
					</svg>
				</div>
				<div class="devices__item js-device-button" data-mode="mobile" data-width="375">
					<svg>
						<use xlink:href="#svg-phone"></use>
					</svg>
				</div>
				<div class="devices__item js-device-button" data-mode="mobile" data-width="480">
					<svg>
						<use xlink:href="#svg-phone"></use>
					</svg>
				</div>
				<div class="devices__item js-device-button" data-mode="ipad" data-width="900">
					<svg>
						<use xlink:href="#svg-tablet"></use>
					</svg>
				</div>
				<div class="devices__item js-device-button" data-mode="desktop" data-width="1366">
					<svg>
						<use xlink:href="#svg-notebook"></use>
					</svg>
				</div>
				<div class="devices__item js-device-button active" data-mode="wide" data-width="1920">
					<svg>
						<use xlink:href="#svg-desktop"></use>
					</svg>
				</div>
				<div class="devices__item js-device-button" data-mode="wide2" data-width="4096">
					<svg>
						<use xlink:href="#svg-desktop"></use>
					</svg>
				</div>
			</div>
		</div>
		<div class="label">
			<ul class="label__container">

				<% i = 0; %>
				<% _.each(pages.PageList, function(page) { i++; %>

				<li class="label__item js-label-name <%
				if(!page.ready){ page.ready = 0; %> disabled <%;}
				else if(page.ready >= 100){ %> ready <%; }
				else{ %> inProgress <%; } %>
				<% if(i==1){ %> active <% } %> ">

				<div class="label__status"></div>

				<a class="label__name js-label-name-link" href="<%= page.file %>">
					<span><%= i %>. </span>
					<%= _.split(page.file, '.', 1) %>

					<% if(!page.ready){ page.ready = 0;}
					else{ %> ( <%= page.ready %>% )<%; } %>
				</a>

				<a href="<%= page.file %>" class="label__url" target="blank">
					<svg><use xlink:href="#svg-link"></use></svg>
				</a>

			</li>

			<% }) %>

		</ul>
	</div>

	<div class="content">
		<div class="content__item" id="preview-wrapper">
			<iframe frameborder="0" class="content__iframe" id="preview" src="<%= pages.PageList[0].file %>" style="opacity: 1; left: 0; right: 0; margin: 0 auto; transform-origin: 0 0;"></iframe>
		</div>
	</div>

</div>
<!-- END content -->
<!-- BEGIN scripts -->
<script>
	var navs = document.querySelectorAll('.js-device-button');
	var body = document.querySelectorAll('body')[0];
	var previewButtons = document.querySelectorAll('.js-label-name');
	var previewButtonsLink = document.querySelectorAll('.js-label-name-link');
	var iframe = document.getElementById('preview');
	var previewWrapper = document.getElementById('preview-wrapper');

	function removeActive(){
		[].forEach.call(previewButtons, function(button) {
			button.classList.remove('active');
		});
	}

	function getScrollbarWidth() {
		var outer = document.createElement("div");
		outer.style.visibility = "hidden";
		outer.style.width = "100px";
		outer.style.msOverflowStyle = "scrollbar"; // needed for WinJS apps

		document.body.appendChild(outer);

		var widthNoScroll = outer.offsetWidth;
		// force scrollbars
		outer.style.overflow = "scroll";

		// add innerdiv
		var inner = document.createElement("div");
		inner.style.width = "100%";
		outer.appendChild(inner);

		var widthWithScroll = inner.offsetWidth;

		// remove divs
		outer.parentNode.removeChild(outer);

		return widthNoScroll - widthWithScroll;
	}
	var  scrollbarwidth = getScrollbarWidth();

	[].forEach.call(previewButtonsLink, function(button) {
		button.addEventListener('click', function(event) {

			if(window.innerWidth < 780){return;}
			event.preventDefault();
			removeActive();
			var el = event.currentTarget;
			var elForClassAdd = event.currentTarget.closest('.js-label-name');
			elForClassAdd.classList.add('active');
			iframe.src = el.href;
		}, false);
	});

	var mode = 'wide';
	[].forEach.call(navs, function(nav) {
		nav.addEventListener('click', function(event) {
			event.preventDefault();
			mode = event.currentTarget.dataset.mode;
			iframe.style.width = parseInt(event.currentTarget.getAttribute('data-width')) + parseInt(scrollbarwidth) + 'px';

			body.setAttribute('data-mode','is-' + mode);


			[].forEach.call(navs, function(nav) {
				nav.classList.remove('active');
			})
			event.currentTarget.classList.add('active');

			setIframeWidth();
		}, false);

		function setIframeWidth(){
			// getting preview area width
			var pwidth = previewWrapper.offsetWidth;
			var pheight = previewWrapper.offsetHeight;

			// iframe width
			var iwidth = iframe.offsetWidth;
			var iheight = iframe.offsetHeight;

			var scaleV = pheight/iheight;
			var scaleH = pwidth/iwidth;

			if(mode=='mobile'){
				iframe.style.transform = 'scale('+ 1 +')';
				iframe.style.height =  pheight + 'px';


				return;
			}
			if(scaleH>1){scaleH = 1;}
			iframe.style.transform = 'scale('+ scaleH +')';

			iframe.style.height =  pheight/scaleH + 'px';
			// console.log(pheight*(2 - scaleV) + 'px');

			var realheight = iframe.getBoundingClientRect().height;

			if(realheight>pheight){
				iframe.style.transform = 'scale('+ scaleV +')';
			}

			// console.log(scaleV,scaleH);
		}

		setIframeWidth();
		// resize event
		window.addEventListener("resize", function(){
			setIframeWidth();
		});


	});
</script>
<!-- END scripts -->
</body>
</html>
